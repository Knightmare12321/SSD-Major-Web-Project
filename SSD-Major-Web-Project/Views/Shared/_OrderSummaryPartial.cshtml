@model ICollection<SSD_Major_Web_Project.ViewModels.OrderVM>
<div class="table-responsive">
    <table class="table transaction-table">
        <thead>
            <tr>
                <th>Order Id</th>
                <th>Order Date</th>
                <th>Status</th>
                <th>Buyer</th>
                <th>Product</th>
                <th>Size</th>
                <th>Qty</th>
                <th>Order Total</th>
                <th>Buyer Note</th>
                <th></th>
                @{
                    if (ViewBag.OrderStatus == "Paid")
                    {

                                    <th></th>
                    }
                }
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                //first Line that lists eveything out
                <tr id="@item.OrderId-0">
                    <td> @Html.DisplayFor(modelItem => item.OrderId)</td>
                    <td> @Html.DisplayFor(modelItem => item.OrderDate)</td>
                    <td class="order-status"> @Html.DisplayFor(modelItem => item.OrderStatus)</td>
                    <td>@Html.DisplayName($"{item.Contact.FirstName} {item.Contact.LastName}")</td>
                    <td> @Html.DisplayFor(modelItem => item.OrderDetails[0].FkSku.FkProduct.Name)</td>
                    <td> @Html.DisplayFor(modelItem => item.OrderDetails[0].FkSku.Size)</td>
                    <td> @Html.DisplayFor(modelItem => item.OrderDetails[0].Quantity)</td>
                    <td> @Html.DisplayFor(modelItem => item.OrderTotal)</td>
                    <td> @Html.DisplayName(item.BuyerNote!=""? "Yes":"No")</td>
                    @{
                        if (ViewBag.OrderStatus == "Paid")
                        {
                                        <td><button class="btn" onclick="dispatchOrder(@item.OrderId)">Dispatch</button></td>
                        }
                    }
                    <td><button class="btn" onClick="getOrderDetail(@Json.Serialize(@item).ToString())">Detail</button></td>
                    <td><button class="btn" onclick="refundOrder(@item.OrderId.ToString())">Refund</button></td>

                </tr>

                //subsequent lines only lists additional order items
                @for (var i = 1; i < item.OrderDetails.Count; i++)
                {
                    <tr id="@item.OrderId-@i">
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td> @Html.DisplayFor(modelItem => item.OrderDetails[i].FkSku.FkProduct.Name)</td>
                        <td> @Html.DisplayFor(modelItem => item.OrderDetails[i].FkSku.Size)</td>
                        <td> @Html.DisplayFor(modelItem => item.OrderDetails[i].Quantity)</td>
                        <td>-</td>
                        <td>-</td>
                        <td></td>
                        <td></td>
                        @{
                            if (ViewBag.OrderStatus == "Paid")
                            {

                                            <td></td>
                            }
                        }
                    </tr>
                }
            }
        </tbody>
    </table>
</div>
